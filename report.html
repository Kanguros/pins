
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firewall Policy Analysis Report</title>
    <style>
        :root {
            --primary-color: #FF6B35;
            --secondary-color: #FF9F1C;
            --accent-color: #EE4B2B;
            --text-color: #333333;
            --bg-cream: #FFF9F0;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            line-height: 1.5;
            margin: 0 auto;
            background-color: white;
            color: var(--text-color);
            max-width: 1000px;
            padding: 1rem;
        }

        .container {
            width: 100%;
            box-shadow: 0 0 10px rgba(0,0,0,0.05);
            border-radius: 8px;
            overflow: hidden;
        }

        .report-header {
            text-align: center;
            padding: 1.2rem;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            margin-bottom: 1rem;
        }

        .report-header h1 {
            margin: 0;
            font-size: 1.6rem;
        }

        .report-header p {
            margin: 0.3rem 0 0;
            font-size: 0.9rem;
        }

        .content {
            padding: 0 1.5rem 1.5rem;
        }
        
        /* Two-column layout */
        .top-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .toc {
            background: white;
            border-bottom: 1px solid #eee;
            padding-bottom: 1rem;
        }

        .toc h2 {
            margin-top: 0.5rem;
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 0.8rem;
        }

        .toc-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .toc-list li {
            margin-bottom: 0.4rem;
        }

        .toc-list a {
            display: grid;
            grid-template-columns: auto max-content;
            text-decoration: none;
            color: var(--text-color);
            align-items: end;
            position: relative;
            overflow: hidden;
        }

        .toc-list a:hover {
            color: var(--primary-color);
        }

        .toc-list a::after {
            content: "";
            position: absolute;
            bottom: 0.3em;
            width: 100%;
            border-bottom: 1px dotted #ccc;
            margin-right: -1rem;
            margin-left: 0.3rem;
        }

        .toc-list a span.title {
            position: relative;
            background: white;
            padding-right: 0.5rem;
            z-index: 1;
        }

        .toc-list a span.page {
            position: relative;
            background: white;
            padding-left: 0.5rem;
            z-index: 1;
            font-weight: 500;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.8rem;
        }

        .summary-card {
            background: white;
            border-radius: 4px;
            padding: 0.7rem;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            border: 1px solid #eee;
            border-left: 3px solid var(--secondary-color);
        }

        .summary-card h3 {
            margin: 0 0 0.3rem 0;
            font-size: 0.9rem;
            color: var(--primary-color);
        }

        .summary-card p {
            margin: 0;
            font-size: 1rem;
            font-weight: 500;
        }

        .finding-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: white;
            border: 1px solid #eee;
        }

        .finding-table th {
            background-color: var(--primary-color);
            color: white;
            padding: 0.5rem;
            text-align: left;
            font-size: 0.85rem;
        }

        .finding-table td {
            padding: 0.5rem;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }

        .finding-table td:first-child {
            background-color: rgba(255, 107, 53, 0.08);
            font-weight: 500;
            max-width: 180px;
        }

        .finding-table tr:hover {
            background-color: rgba(255, 159, 28, 0.03);
        }

        h2.finding-header, h2.checks-header {
            color: var(--accent-color);
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            padding-bottom: 0.3rem;
            border-bottom: 1px solid var(--secondary-color);
            font-size: 1.2rem;
        }
        
        .checks-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        
        .check-item {
            margin-bottom: 1rem;
            padding: 0.8rem;
            background-color: rgba(255, 159, 28, 0.05);
            border-radius: 4px;
            border-left: 3px solid var(--secondary-color);
        }
        
        .check-name {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        
        .check-doc {
            margin: 0;
            font-size: 0.9rem;
            line-height: 1.4;
        }
    </style>
</head>
<body>


    <div class="container">
        <div class="report-header">
            <h1>Firewall Policy Analysis Report</h1>
            <p>Generated: April 25, 2025 08:31:01</p>
        </div>
        
        <div class="content">
            <div class="top-section">
                <div class="toc">
                    <h2>Table of Contents</h2>
                    <ul class="toc-list">
                        <li><a href="#finding-1"><span class="title">Finding 1</span><span class="page">1</span></a></li><li><a href="#finding-2"><span class="title">Finding 2</span><span class="page">2</span></a></li>
                        <li><a href="#checks"><span class="title">Checks</span><span class="page">C</span></a></li>
                    </ul>
                </div>

                <div>
                    <div class="summary-grid">
                        <div class="summary-card">
                            <h3>Total Policies Analyzed</h3>
                            <p>28</p>
                        </div>
                        <div class="summary-card">
                            <h3>Shadowing Findings</h3>
                            <p>2</p>
                        </div>
                        <div class="summary-card">
                            <h3>Affected Rules</h3>
                            <p>4</p>
                        </div>
                        <div class="summary-card">
                            <h3>Analysis Date</h3>
                            <p>2025-04-25</p>
                        </div>
                    </div>
                </div>
            </div>
<h2 class="finding-header" id="finding-1">Finding 1</h2>
<table class="finding-table">
<tr><th>Attribute</th><th>Shadowed Rule</th><th>Preceding Rule 1</th></tr>
<tr><td>index</td><td>10</td><td>9</td></tr>
<tr><td>name</td><td>allow-admin-rdp</td><td>allow-admin-ssh</td></tr>
<tr><td>enabled</td><td>True</td><td>True</td></tr>
<tr><td>action</td><td>allow</td><td>allow</td></tr>
<tr><td>source_zones</td><td>trusted-zone</td><td>trusted-zone</td></tr>
<tr><td>destination_zones</td><td>dmz<br>server-zone</td><td>dmz<br>server-zone</td></tr>
<tr><td>source_addresses</td><td>admin-workstations</td><td>admin-workstations</td></tr>
<tr><td>destination_addresses</td><td>windows-servers</td><td>linux-servers<br>network-devices<br>windows-servers</td></tr>
<tr><td>applications</td><td>ms-rdp</td><td>ms-rdp<br>ssh</td></tr>
<tr><td>services</td><td>application-default</td><td>application-default</td></tr>
<tr><td>category</td><td>any</td><td>any</td></tr>
<tr><td>resolved_source_addresses</td><td>admin-subnet[10.1.0.0/24]</td><td>admin-subnet[10.1.0.0/24]</td></tr>
<tr><td>resolved_destination_addresses</td><td>windows-server-2[192.168.150.11/32]<br>windows-server-1[192.168.150.10/32]</td><td>linux-server-2[192.168.200.11/32]<br>linux-server-1[192.168.200.10/32]<br>network-devices[192.168.120.0/24]<br>windows-server-2[192.168.150.11/32]<br>windows-server-1[192.168.150.10/32]</td></tr>
</table>
<h2 class="finding-header" id="finding-2">Finding 2</h2>
<table class="finding-table">
<tr><th>Attribute</th><th>Shadowed Rule</th><th>Preceding Rule 1</th></tr>
<tr><td>index</td><td>26</td><td>19</td></tr>
<tr><td>name</td><td>allow-cam</td><td>allow-video-conferencing</td></tr>
<tr><td>enabled</td><td>True</td><td>True</td></tr>
<tr><td>action</td><td>allow</td><td>allow</td></tr>
<tr><td>source_zones</td><td>trusted-zone</td><td>trusted-zone</td></tr>
<tr><td>destination_zones</td><td>internet</td><td>internet</td></tr>
<tr><td>source_addresses</td><td>corporate-workstations</td><td>smart-devices<br>corporate-workstations</td></tr>
<tr><td>destination_addresses</td><td>any</td><td>any</td></tr>
<tr><td>applications</td><td>google-meet<br>ms-teams<br>zoom<br>webex</td><td>ms-teams<br>https<br>google-meet<br>zoom<br>webex</td></tr>
<tr><td>services</td><td>application-default</td><td>application-default</td></tr>
<tr><td>category</td><td>collaboration</td><td>collaboration</td></tr>
<tr><td>resolved_source_addresses</td><td>corp-subnet-2[10.3.1.0/24]<br>corp-subnet-1[10.3.0.0/24]</td><td>iot-subnet[10.2.0.0/24]<br>corp-subnet-2[10.3.1.0/24]<br>corp-subnet-1[10.3.0.0/24]</td></tr>
<tr><td>resolved_destination_addresses</td><td>None</td><td>None</td></tr>
</table>
<h2 class="checks-header" id="checks">Checks</h2>
<div class="checks-list">

        <div class="check-item">
            <div class="check-name">check_action</div>
            <p class="check-doc">Checks if both rules have the same action (like &#x27;allow&#x27; or &#x27;deny&#x27;).
If the actions are different, the first rule does not fully hide the second one.</p>
        </div>
        

        <div class="check-item">
            <div class="check-name">check_application</div>
            <p class="check-doc">Checks if the first rule allows all the same applications as the second rule.
If the first rule uses &#x27;any&#x27; or all the same apps, it can hide the second rule.</p>
        </div>
        

        <div class="check-item">
            <div class="check-name">check_services</div>
            <p class="check-doc">Checks if the first rule allows all the same network services or ports.
If the first rule covers all the same services, it can hide the second rule.</p>
        </div>
        

        <div class="check-item">
            <div class="check-name">check_source_zone</div>
            <p class="check-doc">Checks if the first rule covers all the same source zones as the second rule.
If the first rule uses &#x27;any&#x27; or all the same zones, it can hide the second rule.</p>
        </div>
        

        <div class="check-item">
            <div class="check-name">check_destination_zone</div>
            <p class="check-doc">Checks if the first rule covers all the same destination zones as the second rule.
If the first rule uses &#x27;any&#x27; or all the same zones, it can hide the second rule.</p>
        </div>
        

        <div class="check-item">
            <div class="check-name">check_source_addresses_by_ip</div>
            <p class="check-doc">Check if rule&#x27;s source IP addresses are covered by preceding rule.

Excludes FQDN address objects from comparison and logs warnings when encountered.</p>
        </div>
        

        <div class="check-item">
            <div class="check-name">check_destination_addresses_by_ip</div>
            <p class="check-doc">Check if rule&#x27;s destination IP addresses are covered by preceding rule.

Excludes FQDN address objects from comparison and logs warnings when encountered.</p>
        </div>
        
</div>
</div></div>

</body>
</html>
